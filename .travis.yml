language: node_js
matrix:
  include:
  - node_js: '9'
    os: osx
    script: npm run test:integration
  - node_js: '9'
    sudo: required
    os: linux
    dist: trusty
    addons:
      chrome: stable
      firefox: latest
    before_script:
    - export DISPLAY=:99.0
    - sh -e /etc/init.d/xvfb start
    script:
    - npm run test:unit
    - if [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then npm run test:sauce; fi
deploy:
  provider: s3
  access_key_id: AKIAIGKXVNFPSU7YOGYQ
  secret_access_key:
    secure: vm/VGebBkLd8BR1uyZJ/p6KUpjlq37s7wDlv0I+NcqQYuM0/Lf1nDxkVssv5oGPRyXPsWZIzqJH9fHqxhFfHcZ96uuyA9e7HP2iXs0Dx0JcISARom2g5YFBHIJdTCja9gpSLHbowRfYfEmconhAyox421wmK+Owt0j7p9VnmrvaVIamcsQSC1QNj8ACExZQDx9lOig3HPfhhqSlRKsJJz+cZAuqcvOgT36V3xGrg8tPMtHr7Cj1ipyqzzjfGkfYTkailjQJcZGHtTGVfKdKadRc4+S4As+C7+hTYoafc1V40Yfw/q/0SnYC9qPcgPh8TJOOXN8dkJr+0DlbsNa6rbjX1sK9uP3xgY6XNqaGkirEse02l1GOYZliqHR1WT/QmIvZY+kMFqQ72xkRQACXfloU2xPjX7kW0DsmDbw2UFxsOW/yISHWY35P0G6vNYA00jmu4QGZqMT64nqk1NMefKWb/UJ5V91LurOtZIjkP9Gu4zpY8GFMcbM33e2v+xUtlI99YdEwl7u4jJ//nZftz3beGAQSH6PU/q7BlTVOE9W+uItYi7wdn9Jv8hKNCp2nzQT7WOQ5vCAwHR6SaaBsxery2NXy5cDLLJFKF9CelbnZqCZd+H7uvIKrS8u1R6e3sLtAbAaMooF1QuWB/lGSYL7lEOdRCOavsSqQI1th2swI=
  bucket: fitnessapp.tld
  region: eu-west-2
  skip_cleanup: true
  local-dir: build
  acl: public_read
  on:
    repo: bobbydeveaux/fitnessapp2
after_deploy:
  - aws configure set preview.cloudfront true
  - aws cloudfront create-invalidation --distribution-id ERXCI0CPDJBBR --paths "/*"