<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <style type="text/css">
    	@mixin hover() {
			  .md-no-touch &:hover {
			    @content;
			  }
			}

			.md-button {
			  @include hover {
			    // hover styles
			  }
			}
		</style>
    <title>Macro Calculator</title>
  </head>
  <body>
    

    <div class="container">
    	<h1>Macro Calculation - Demo</h1>
    	<div style="padding:20px">
		    <form>
				  <div class="form-group row">
				    <label for="inputHeight">Height (inches)</label>
						<input type="number" pattern="\d*" id="inputHeight" class="form-control form-control-lg" placeholder="72" aria-describedby="heightHelpBlock">
						<p id="heightHelpBlock" class="form-text text-muted">
						  1ft = 12 inches. 5ft = 60 inches. 6ft = 72 inches One day we will allow metric too.. ;-)
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputWaist">Waist (inches)</label>
						<input type="number" pattern="\d*" id="inputWaist" class="form-control form-control-lg" placeholder="32"aria-describedby="waistHelpBlock">
						<p id="waistHelpBlock" class="form-text text-muted">
						  Enter your measurement around the belly button, in inches.
						</p>
				  </div>
				   <div class="form-group row">
				    <label for="inputNeck">Neck (inches)</label>
						<input type="number" pattern="\d*" id="inputNeck" class="form-control form-control-lg" placeholder="15"aria-describedby="neckHelpBlock">
						<p id="neckHelpBlock" class="form-text text-muted">
						  Enter the largest measurement around your neck!
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputWeight">Weight (kg)</label>
						<input type="number" pattern="\d*" id="inputWeight" class="form-control form-control-lg" placeholder="79"aria-describedby="weightHelpBlock">
						<p id="weightHelpBlock" class="form-text text-muted">
						  Enter your weight in kg. 1st = 	6.35kg,
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputHip">Hip Measurement (inches) - Females only!</label>
						<input type="number" pattern="\d*" id="inputHip" class="form-control form-control-lg" placeholder="0" aria-describedby="hipHelpBlock">
						<p id="hipHelpBlock" class="form-text text-muted">
						  If your gender at birth was male, leave this blank.
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputBia">Fat Percentage (%)</label>
						<input type="number" pattern="\d*" id="inputBia" class="form-control form-control-lg" placeholder="15"aria-describedby="biaHelpBlock">
						<p id="biaHelpBlock" class="form-text text-muted">
						  We will calculate your approx fat percentage anyway, but if you've had a reading done, enter it here. Otherwise, leave it blank.
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputActivity">How active are you?</label>
				    <select class="form-control form-control-lg" id="inputActivity" aria-describedby="activityHelpBlock">
				      <option value="low">Sedentary</option>
				      <option value="light">Lightly Active</option>
				      <option value="moderate">Moderately Active</option>
				      <option value="very">Very Active</option>
				      <option value="extreme">Extemely Active</option>
				    </select>
				    <p id="activityHelpBlock" class="form-text text-muted">
						  Sedentary - little or no exercise, desk job<br/>
						  Lightly active - light exercise/ sports 1-3 days/week<br/>
							Moderately active - BMR x 1.55 (moderate exercise/ sports 6-7 days/week<br/>
							Very active - hard exercise every day, or exercising 2 xs/day<br/>
							Extra active - hard exercise 2 or more times per day, or training for marathon, or triathlon, etc.
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputLifestyle">What's your diet preference?</label>
				    <select class="form-control form-control-lg" id="inputLifestyle" aria-describedby="lifestyleHelpBlock">
				      <option value="lchf">LCHF - Low Carb, High Fat (keto-style)</option>
				      <option value="hclf">HCLF - High Carb, Low Fat</option>
				      <option value="psmf">PSMF - Protein Sparing Modified Fast</option>
				      <option value="balanced">Balanced</option>
				      <option value="gains">Super Carb</option>
				    </select>
				    <p id="lifestyleHelpBlock" class="form-text text-muted">
						  Apart from 'super carb' & 'Protein Sparing', all diets assume 2.2g protein per kg body weight. Thats the same as 1g / 1lb of body weight - standard practice. <br/>'Super carb' is for those bulking, and want to maximise carb intake, which reduces protein to 0.8g per lb of body weight.<br />
						  'PSMF' - This is only for those that wish to undertake a temporary controlled fast and minmise muscle loss. Doctor Supervision recommended.
						</p>
				  </div>
				  <div class="form-group row">
				    <label for="inputDeficit">Are looking to make lean gains, or lose fat?</label>
				    <select class="form-control form-control-lg" id="inputDeficit" aria-describedby="deficitHelpBlock">
				      <option value="leangains">Lean Gains</option>
				      <option value="maintain">Maintenance</option>
				      <option value="slow">Controlled, slow fat loss</option>
				      <option value="easy">Steady fat loss</option>
				      <option value="medium">Moderate fat loss</option>
				      <option value="hard">Help me lose a lot of fat, please - I can do this!</option>
				    </select>
				    <p id="lifestyleHelpBlock" class="form-text text-muted">
						  Maintenance should allow you to stay the same weight.<br />
						  All are within safe parameters off caloric control.
						</p>
				  </div>
				  <button id="calculate" type="button" class="btn btn-primary btn-lg md-button">Calculate</button>
				</form>
			</div>
			<div id="results">
				
			</div>
			<br />
		</div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"  crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script>

    	// Read a page's GET URL variables and return them as an associative array.
			function getUrlVars()
			{
			    var vars = [], hash;
			    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
			    for(var i = 0; i < hashes.length; i++)
			    {
			        hash = hashes[i].split('=');
			        vars[hash[0]] = hash[1];
			    }
			    return vars;
			}

    	var resultsTemplate = '<h2>Results</h2><p>Based on your measurements & goals, you should aim to eat around <strong>{calories}kcal</strong>, made up of <strong>{protein}g protein</strong>, <strong>{carbs}g carbs</strong> and <strong>{fat}g fat</strong>. As a rule of thumb,  dont\'t stress too much about the carbs and fat; just make sure you hit the protein &amp; calorie goals!</p><p>We calculated that your basal metabolic rate (BMR) is <strong>{bmr}kcal</strong> - this is the total amount of calories you would burn each day without even getting out of bed!</p><p>Based on your activity level, you have a Total Daily Energy Expenditure (TDEE) of around <strong>{tdee}kcal</strong>.</p><p>Your fat percentage, using the US Navy formula is approx. <strong>{fatpercent}%</strong></p><p>Share your result: <a href="/demo.html?{shareurl}">Copy Link</a></p>';

    	$(function() {

    		var qs = getUrlVars();
    		if (qs['height']) {
    			$('#inputHeight').val(qs['height']);
    		}
    		if (qs['waist']) {
    			$('#inputWaist').val(qs['waist']);
    		}
    		if (qs['mass']) {
    			$('#inputWeight').val(qs['mass']);
    		}
    		if (qs['neck']) {
    			$('#inputNeck').val(qs['neck']);
    		}
    		if (qs['activity']) {
    			$('#inputActivity').val(qs['activity']);
    		}
    		if (qs['lifestyle']) {
    			$('#inputLifestyle').val(qs['lifestyle']);
    		}
    		if (qs['deficit']) {
    			$('#inputDeficit').val(qs['deficit']);
    		}
    		if (qs['bia']) {
    			$('#inputBia').val(qs['bia']);
    		}
    		if (qs['hip']) {
    			$('#inputHip').val(qs['hip']);
    		}

    		$('#calculate').click(function(){

    			var height = $('#inputHeight').val() ? $('#inputHeight').val() : 0;
	    		var waist = $('#inputWaist').val() ? $('#inputWaist').val() : 0;
	    		var mass = $('#inputWeight').val() ? $('#inputWeight').val() : 0;
	    		var neck = $('#inputNeck').val() ? $('#inputNeck').val() : 0;
	    		var activity = $('#inputActivity').val();
	    		var lifestyle = $('#inputLifestyle').val();
	    		var deficit = $('#inputDeficit').val();
	    		var bia = $('#inputBia').val() ? $('#inputBia').val() : 0;
	    		var hip = $('#inputHip').val() ? $('#inputHip').val() : 0;

	    		var data = { 
				    height: height, 
				    waist: waist, 
				    mass: mass, 
				    neck: neck, 
				    activity: activity, 
				    lifestyle: lifestyle, 
				    deficit: deficit, 
				    bia: bia,
				    hip: hip
				  }

				  var shareUrl = $.param(data);

	    		$.ajax({
					  url: "https://2gubl4qlic.execute-api.eu-west-2.amazonaws.com/v1/stats3",
					  type: "GET",
					  data: data,
					  success: function(response) {
					    txtResults = resultsTemplate.replace(/{calories}/, response.calcs.caloriegoal);
					    txtResults = txtResults.replace(/{protein}/, response.calcs.proteingoal);
					    txtResults = txtResults.replace(/{carbs}/, response.calcs.carbgoal);
					    txtResults = txtResults.replace(/{fat}/, response.calcs.fatgoal);
					    txtResults = txtResults.replace(/{fatpercent}/, response.calcs.fatpercent);
					    txtResults = txtResults.replace(/{bmr}/, response.calcs.bmr);
					    txtResults = txtResults.replace(/{tdee}/, response.calcs.tdee);
					    txtResults = txtResults.replace(/{shareurl}/, shareUrl);
					    
					    
					    $('#results').html(txtResults);
					  }
					});
    		});

    		
    	});
    	
    </script>

  </body>
</html>